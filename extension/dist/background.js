(()=>{"use strict";var e={992:(e,t)=>{var n=Object.prototype.hasOwnProperty;function o(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function r(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){t=t||"";var o,a,c=[];for(a in"string"!=typeof t&&(t="?"),e)if(n.call(e,a)){if((o=e[a])||null!=o&&!isNaN(o)||(o=""),a=r(a),o=r(o),null===a||null===o)continue;c.push(a+"="+o)}return c.length?t+c.join("&"):""},t.parse=function(e){for(var t,n=/([^=?#&]+)=?([^&]*)/g,r={};t=n.exec(e);){var a=o(t[1]),c=o(t[2]);null===a||null===c||a in r||(r[a]=c)}return r}},63:e=>{e.exports=function(e,t){if(t=t.split(":")[0],!(e=+e))return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},723:(e,t,n)=>{n.d(t,{l:()=>s});var o=n(562),r=n(663),a=function(){return a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)},c=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function c(e){try{s(o.next(e))}catch(e){a(e)}}function i(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((o=o.apply(e,t||[])).next())}))},i=function(e,t){var n,o,r,a,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},s=function(e,t){return c(void 0,void 0,void 0,(function(){return i(this,(function(n){return chrome.storage.local.get("pageview_".concat(t),(function(n){return c(void 0,void 0,void 0,(function(){var c,s,u,l;return i(this,(function(i){switch(i.label){case 0:return(c=n["pageview_".concat(t)])?(s=a(a({},e),{page_view_id:c}),u=function(e){console.log("Event created successfully:",e),(0,r.S)(e)},l=function(e){console.error("Error creating event:",e),(0,r.B)(e)},[4,(0,o.w)({endpoint:"/events/create",type:"POST",data:s,onSuccess:u,onFailure:l})]):(console.error("No page view ID found for tab ID: ".concat(t)),[2]);case 1:return i.sent(),[2]}}))}))})),[2]}))}))}},734:(e,t,n)=>{n.d(t,{E:()=>u,l:()=>s});var o=n(562),r=n(663),a=function(){return a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)},c=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function c(e){try{s(o.next(e))}catch(e){a(e)}}function i(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((o=o.apply(e,t||[])).next())}))},i=function(e,t){var n,o,r,a,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},s=function(e,t){return c(void 0,void 0,void 0,(function(){return i(this,(function(n){return chrome.storage.local.get("session_".concat(t),(function(n){return c(void 0,void 0,void 0,(function(){var c,s,u,l;return i(this,(function(i){switch(i.label){case 0:return(c=n["session_".concat(t)])?(s=a(a({},e),{session_id:c}),u=function(e){var n;console.log("Page view started successfully:",e);var o=e.pageview_id;o&&chrome.storage.local.set(((n={})["pageview_".concat(t)]=o,n),(function(){console.log("Page view ID ".concat(o," saved for tab ").concat(t))})),(0,r.S)(e)},l=function(e){console.error("Error starting page view:",e),(0,r.B)(e)},[4,(0,o.w)({endpoint:"/pageviews/start",type:"POST",data:s,onSuccess:u,onFailure:l})]):(console.error("No session ID found for tab ID: ".concat(t)),[2]);case 1:return i.sent(),[2]}}))}))})),[2]}))}))},u=function(e,t){return c(void 0,void 0,void 0,(function(){return i(this,(function(n){return chrome.storage.local.get("pageview_".concat(e),(function(n){return c(void 0,void 0,void 0,(function(){var a,c,s,u,l;return i(this,(function(i){switch(i.label){case 0:return(a=n["pageview_".concat(e)])?(c={pageview_id:a,active_time:t},s=function(t){console.log("Page view ended successfully:",t),chrome.storage.local.remove("pageview_".concat(e)),(0,r.S)(t)},u=function(e){console.error("Error ending page view:",e),(0,r.B)(e)},l="/pageviews/end/".concat(a),[4,(0,o.w)({endpoint:l,type:"PUT",data:c,onSuccess:s,onFailure:u})]):(console.error("No page view ID found for tab ID: ".concat(e)),[2]);case 1:return i.sent(),[2]}}))}))})),[2]}))}))}},175:(e,t,n)=>{n.d(t,{J:()=>i,k:()=>s});var o=n(562),r=n(663),a=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function c(e){try{s(o.next(e))}catch(e){a(e)}}function i(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((o=o.apply(e,t||[])).next())}))},c=function(e,t){var n,o,r,a,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=function(e,t){return a(void 0,void 0,void 0,(function(){var n,a;return c(this,(function(c){switch(c.label){case 0:return n=function(e){var n;console.log("Session started successfully:",e);var o=e.session_id;o&&chrome.storage.local.set(((n={})["session_".concat(t)]=o,n),(function(){console.log("Session ID ".concat(o," saved for tab ").concat(t))})),(0,r.S)(e,(function(){}))},a=function(e){console.error("Error starting session:",e),(0,r.B)(e,(function(){}))},[4,(0,o.w)({endpoint:"/sessions/start",type:"POST",data:e,onSuccess:n,onFailure:a})];case 1:return c.sent(),[2]}}))}))},s=function(e,t){return a(void 0,void 0,void 0,(function(){return c(this,(function(n){return chrome.storage.local.get("session_".concat(e),(function(n){return a(void 0,void 0,void 0,(function(){var a,i,s,u,l;return c(this,(function(c){switch(c.label){case 0:return(a=n["session_".concat(e)])?(i={session_id:a,active_time:t},s=function(t){console.log("Session ended successfully:",t),chrome.storage.local.remove("session_".concat(e)),(0,r.S)(t)},u=function(e){console.error("Error ending session:",e),(0,r.B)(e)},l="/sessions/end/".concat(a),[4,(0,o.w)({endpoint:l,type:"PUT",data:i,onSuccess:s,onFailure:u})]):(console.error("No session ID found for tab ID: ".concat(e)),[2]);case 1:return c.sent(),[2]}}))}))})),[2]}))}))}},562:(e,t,n)=>{n.d(t,{w:()=>i});var o=n(230),r=n(185),a=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function c(e){try{s(o.next(e))}catch(e){a(e)}}function i(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((o=o.apply(e,t||[])).next())}))},c=function(e,t){var n,o,r,a,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=function(e){var t=e.endpoint,n=e.type,i=e.data,u=e.onSuccess,l=e.onFailure;return a(void 0,void 0,void 0,(function(){var e,a,f,p,h,d;return c(this,(function(c){switch(c.label){case 0:return c.trys.push([0,4,,5]),[4,(0,o.gf)()];case 1:if(!(e=c.sent()))throw new Error("Access token is null");return a="".concat(r.J).concat(t),f={"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},p={method:n,headers:f},i&&(p.body=JSON.stringify(i)),[4,fetch(a,p)];case 2:return[4,s(c.sent())];case 3:return h=c.sent(),u&&u(h),[3,5];case 4:return d=c.sent(),console.error("Error in sendRequest:",d),l&&l(d instanceof Error?d:new Error(String(d))),[3,5];case 5:return[2]}}))}))};function s(e){return a(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return e.ok?[3,2]:[4,e.text()];case 1:throw t=n.sent(),new Error("HTTP error! status: ".concat(e.status,", body: ").concat(t));case 2:return[2,e.json()]}}))}))}},230:(e,t,n)=>{n.d(t,{B0:()=>c,gf:()=>a});var o=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function c(e){try{s(o.next(e))}catch(e){a(e)}}function i(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((o=o.apply(e,t||[])).next())}))},r=function(e,t){var n,o,r,a,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=function(){return o(void 0,void 0,void 0,(function(){return r(this,(function(e){return[2,new Promise((function(e){chrome.storage.local.get(["access_token"],(function(t){t.access_token?e(t.access_token):e(null)}))}))]}))}))};function c(){return o(this,void 0,void 0,(function(){return r(this,(function(e){return[2,new Promise((function(e,t){chrome.storage.local.get(["access_token"],(function(t){t.access_token?e(!0):e(!1)}))}))]}))}))}},185:(e,t,n)=>{n.d(t,{J:()=>o});var o="http://127.0.0.1:8000"},663:(e,t,n)=>{n.d(t,{B:()=>r,S:()=>o});var o=function(e,t){console.log("Request succeeded with response:",e),t&&t(e)},r=function(e,t){console.error("Request failed with error:",e),t&&t(e)}},960:(e,t,n)=>{n.d(t,{aX:()=>a});var o=n(160),r=n.n(o);function a(e){return new(r())(e).hostname}},160:(e,t,n)=>{var o=n(63),r=n(992),a=/^[\x00-\x20\u00a0\u1680\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]+/,c=/[\n\r\t]/g,i=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,s=/:\d+$/,u=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\\/]+)?([\S\s]*)/i,l=/^[a-zA-Z]:/;function f(e){return(e||"").toString().replace(a,"")}var p=[["#","hash"],["?","query"],function(e,t){return v(t.protocol)?e.replace(/\\/g,"/"):e},["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d*)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],h={hash:1,query:1};function d(e){var t,o=("undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{}).location||{},r={},a=typeof(e=e||o);if("blob:"===e.protocol)r=new b(unescape(e.pathname),{});else if("string"===a)for(t in r=new b(e,{}),h)delete r[t];else if("object"===a){for(t in e)t in h||(r[t]=e[t]);void 0===r.slashes&&(r.slashes=i.test(e.href))}return r}function v(e){return"file:"===e||"ftp:"===e||"http:"===e||"https:"===e||"ws:"===e||"wss:"===e}function w(e,t){e=(e=f(e)).replace(c,""),t=t||{};var n,o=u.exec(e),r=o[1]?o[1].toLowerCase():"",a=!!o[2],i=!!o[3],s=0;return a?i?(n=o[2]+o[3]+o[4],s=o[2].length+o[3].length):(n=o[2]+o[4],s=o[2].length):i?(n=o[3]+o[4],s=o[3].length):n=o[4],"file:"===r?s>=2&&(n=n.slice(2)):v(r)?n=o[4]:r?a&&(n=n.slice(2)):s>=2&&v(t.protocol)&&(n=o[4]),{protocol:r,slashes:a||v(r),slashesCount:s,rest:n}}function b(e,t,n){if(e=(e=f(e)).replace(c,""),!(this instanceof b))return new b(e,t,n);var a,i,s,u,h,y,m=p.slice(),g=typeof t,x=this,k=0;for("object"!==g&&"string"!==g&&(n=t,t=null),n&&"function"!=typeof n&&(n=r.parse),a=!(i=w(e||"",t=d(t))).protocol&&!i.slashes,x.slashes=i.slashes||a&&t.slashes,x.protocol=i.protocol||t.protocol||"",e=i.rest,("file:"===i.protocol&&(2!==i.slashesCount||l.test(e))||!i.slashes&&(i.protocol||i.slashesCount<2||!v(x.protocol)))&&(m[3]=[/(.*)/,"pathname"]);k<m.length;k++)"function"!=typeof(u=m[k])?(s=u[0],y=u[1],s!=s?x[y]=e:"string"==typeof s?~(h="@"===s?e.lastIndexOf(s):e.indexOf(s))&&("number"==typeof u[2]?(x[y]=e.slice(0,h),e=e.slice(h+u[2])):(x[y]=e.slice(h),e=e.slice(0,h))):(h=s.exec(e))&&(x[y]=h[1],e=e.slice(0,h.index)),x[y]=x[y]||a&&u[3]&&t[y]||"",u[4]&&(x[y]=x[y].toLowerCase())):e=u(e,x);n&&(x.query=n(x.query)),a&&t.slashes&&"/"!==x.pathname.charAt(0)&&(""!==x.pathname||""!==t.pathname)&&(x.pathname=function(e,t){if(""===e)return t;for(var n=(t||"/").split("/").slice(0,-1).concat(e.split("/")),o=n.length,r=n[o-1],a=!1,c=0;o--;)"."===n[o]?n.splice(o,1):".."===n[o]?(n.splice(o,1),c++):c&&(0===o&&(a=!0),n.splice(o,1),c--);return a&&n.unshift(""),"."!==r&&".."!==r||n.push(""),n.join("/")}(x.pathname,t.pathname)),"/"!==x.pathname.charAt(0)&&v(x.protocol)&&(x.pathname="/"+x.pathname),o(x.port,x.protocol)||(x.host=x.hostname,x.port=""),x.username=x.password="",x.auth&&(~(h=x.auth.indexOf(":"))?(x.username=x.auth.slice(0,h),x.username=encodeURIComponent(decodeURIComponent(x.username)),x.password=x.auth.slice(h+1),x.password=encodeURIComponent(decodeURIComponent(x.password))):x.username=encodeURIComponent(decodeURIComponent(x.auth)),x.auth=x.password?x.username+":"+x.password:x.username),x.origin="file:"!==x.protocol&&v(x.protocol)&&x.host?x.protocol+"//"+x.host:"null",x.href=x.toString()}b.prototype={set:function(e,t,n){var a=this;switch(e){case"query":"string"==typeof t&&t.length&&(t=(n||r.parse)(t)),a[e]=t;break;case"port":a[e]=t,o(t,a.protocol)?t&&(a.host=a.hostname+":"+t):(a.host=a.hostname,a[e]="");break;case"hostname":a[e]=t,a.port&&(t+=":"+a.port),a.host=t;break;case"host":a[e]=t,s.test(t)?(t=t.split(":"),a.port=t.pop(),a.hostname=t.join(":")):(a.hostname=t,a.port="");break;case"protocol":a.protocol=t.toLowerCase(),a.slashes=!n;break;case"pathname":case"hash":if(t){var c="pathname"===e?"/":"#";a[e]=t.charAt(0)!==c?c+t:t}else a[e]=t;break;case"username":case"password":a[e]=encodeURIComponent(t);break;case"auth":var i=t.indexOf(":");~i?(a.username=t.slice(0,i),a.username=encodeURIComponent(decodeURIComponent(a.username)),a.password=t.slice(i+1),a.password=encodeURIComponent(decodeURIComponent(a.password))):a.username=encodeURIComponent(decodeURIComponent(t))}for(var u=0;u<p.length;u++){var l=p[u];l[4]&&(a[l[1]]=a[l[1]].toLowerCase())}return a.auth=a.password?a.username+":"+a.password:a.username,a.origin="file:"!==a.protocol&&v(a.protocol)&&a.host?a.protocol+"//"+a.host:"null",a.href=a.toString(),a},toString:function(e){e&&"function"==typeof e||(e=r.stringify);var t,n=this,o=n.host,a=n.protocol;a&&":"!==a.charAt(a.length-1)&&(a+=":");var c=a+(n.protocol&&n.slashes||v(n.protocol)?"//":"");return n.username?(c+=n.username,n.password&&(c+=":"+n.password),c+="@"):n.password?(c+=":"+n.password,c+="@"):"file:"!==n.protocol&&v(n.protocol)&&!o&&"/"!==n.pathname&&(c+="@"),(":"===o[o.length-1]||s.test(n.hostname)&&!n.port)&&(o+=":"),c+=o+n.pathname,(t="object"==typeof n.query?e(n.query):n.query)&&(c+="?"!==t.charAt(0)?"?"+t:t),n.hash&&(c+=n.hash),c}},b.extractProtocol=w,b.location=d,b.trimLeft=f,b.qs=r,e.exports=b}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=n(175),t=n(734),o=n(230),r=n(960),a=n(723),c=function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function c(e){try{s(o.next(e))}catch(e){a(e)}}function i(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,i)}s((o=o.apply(e,t||[])).next())}))},i=function(e,t){var n,o,r,a,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(c=0)),c;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},s={};function u(n,o){return c(this,void 0,void 0,(function(){var r,a,c;return i(this,(function(i){switch(i.label){case 0:return r={id:"",url:o,device_type:"detectDeviceType",browser_type:"detectBrowserType"},[4,(0,e.J)(r,n)];case 1:return a=i.sent(),c={session_id:a,url:o},[4,(0,t.l)(c,n)];case 2:return i.sent(),s[n]={url:o,startTime:Date.now(),isActive:!0,accumulatedActiveTime:0},[2]}}))}))}function l(n){return c(this,void 0,void 0,(function(){var o,r;return i(this,(function(a){switch(a.label){case 0:return(o=s[n])?(r=o.isActive?Date.now()-o.startTime+o.accumulatedActiveTime:o.accumulatedActiveTime,[4,(0,t.E)(n,r)]):[2];case 1:return a.sent(),[4,(0,e.k)(n,0)];case 2:return a.sent(),delete s[n],[2]}}))}))}function f(e,n){var o;return c(this,void 0,void 0,(function(){var a,c,f,p,h;return i(this,(function(i){switch(i.label){case 0:return a=null===(o=s[e])||void 0===o?void 0:o.url,c=(0,r.aX)(a),f=(0,r.aX)(n),c===f?[3,3]:[4,l(e)];case 1:return i.sent(),[4,u(e,n)];case 2:return i.sent(),[3,6];case 3:return p=s[e],h=p.isActive?Date.now()-p.startTime+p.accumulatedActiveTime:p.accumulatedActiveTime,[4,(0,t.E)(e,h)];case 4:return i.sent(),[4,(0,t.l)({url:n},e)];case 5:i.sent(),s[e]={url:n,startTime:Date.now(),isActive:!0,accumulatedActiveTime:0},i.label=6;case 6:return[2]}}))}))}function p(e,t){var n=s[e];if(n){var o=Date.now();t?(n.startTime=o,n.isActive=!0):n.isActive&&(n.accumulatedActiveTime+=o-n.startTime,n.isActive=!1)}}chrome.tabs.onUpdated.addListener((function(e,t,n){return c(void 0,void 0,void 0,(function(){return i(this,(function(n){switch(n.label){case 0:return t.url&&"chrome://newtab/"!==t.url?[4,(0,o.B0)()]:[2];case 1:return n.sent()?s[e]&&(0,r.aX)(s[e].url)===(0,r.aX)(t.url)?[3,3]:[4,u(e,t.url)]:(console.log("Token not found. Actions will not be performed."),[2]);case 2:return n.sent(),[3,5];case 3:return s[e]&&(0,r.aX)(s[e].url)===(0,r.aX)(t.url)?[4,f(e,t.url)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))})),chrome.tabs.onRemoved.addListener((function(e){return c(void 0,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return s[e]?[4,l(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})),chrome.tabs.onActivated.addListener((function(e){p(e.tabId,!0),Object.keys(s).forEach((function(t){parseInt(t)!==e.tabId&&p(parseInt(t),!1)}))})),chrome.windows.onFocusChanged.addListener((function(e){e===chrome.windows.WINDOW_ID_NONE?Object.keys(s).forEach((function(e){p(parseInt(e),!1)})):chrome.tabs.query({active:!0,windowId:e},(function(e){e.length>0&&p(e[0].id,!0)}))})),chrome.tabs.onActivated.addListener((function(e){p(e.tabId,!0),chrome.tabs.query({windowId:e.windowId},(function(t){t.forEach((function(t){t.id!==e.tabId&&p(t.id,!1)}))}))})),chrome.runtime.onMessage.addListener((function(e,t,n){var o;"createEvent"===e.action&&(null===(o=t.tab)||void 0===o?void 0:o.id)&&(0,a.l)(e.data,t.tab.id).then((function(){console.log("Event logged successfully")})).catch((function(e){console.error("Error logging event:",e)}))}))})()})();